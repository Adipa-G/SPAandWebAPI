<div class="row">
  <div class="col-md-4 offset-md-2">
    <div class="mb-3">
      <label for="logLevel" class="form-label">Level</label>
      <select class="form-control" id="logLevel"
        [(ngModel)]="filter.logLevel"
        (ngModelChange)="updateView(filter)">
        <option [value]=""></option>
        @for (level of logLevels; track level) {
          <option [value]="level">{{level}}</option>
        }
      </select>
    </div>
  </div>
  <div class="col-md-4">
    <div class="mb-3">
      <label for="trackId" class="form-label">Track Id</label>
      <input type="text" class="form-control"
        id="trackId"
        [(ngModel)]="filter.trackingId"
        (ngModelChange)="updateView(filter)"/>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-4 offset-md-2">
      <label>Date From</label>
      <div class="mb-3">
        <input type="text"
          [(ngModel)]="filter.fromDateLocal"
          class="form-control"
          placeholder="yyyy-MM-dd"
          (ngModelChange)="updateView(filter)" />
        </div>

      </div>
      <div class="col-md-4">
        <label>Date To</label>
        <div class="mb-3">
          <input type="text"
            [(ngModel)]="filter.toDateLocal"
            class="form-control"
            placeholder="yyyy-MM-dd"
            (ngModelChange)="updateView(filter)" />
          </div>
        </div>
      </div>
      <div class="row mt-4">
        <div class="col-md-10 offset-md-1">
          <div class="table-responsive">
            <table class="table table-striped table-bordered table-hover">
              <thead>
                <tr>
                  <th [sort-header]="filter" order-field="CalledOn" text="Time" (order-changed)="updateView(filter)"></th>
                  <th [sort-header]="filter" order-field="TrackingId" text="Tracking Id" (order-changed)="updateView(filter)"></th>
                  <th [sort-header]="filter" order-field="RequestIdentity" text="Caller" (order-changed)="updateView(filter)"></th>
                  <th [sort-header]="filter" order-field="StatusCode" text="Status" (order-changed)="updateView(filter)"></th>
                  <th [sort-header]="filter" order-field="CallDuration" text="Duration(s)" (order-changed)="updateView(filter)"></th>
                  <th>Details</th>
                </tr>
              </thead>
              <tbody>
                @for (log of httpLogs; track log) {
                  <tr>
                    <td [utc-to-local]="log.logTimestamp"></td>
                    <td>{{ log.trackingId }}</td>
                    <td>{{ log.caller }}</td>
                    <td>{{ log.status }}</td>
                    <td>{{ log.duration }}</td>
                    <td>
                      <dl class="row">
                        <dt class="col-sm-1">Verb</dt>
                        <dd class="col-sm-11">{{ log.verb }}</dd>
                        <dt class="col-sm-1">Url</dt>
                        <dd class="col-sm-11">{{ log.requestUri }}</dd>
                        <dt class="col-sm-1">Request</dt>
                        <dd class="col-sm-11" [pretty-print]="log.request"></dd>
                        <dt class="col-sm-1">Response</dt>
                        <dd class="col-sm-11" [pretty-print]="log.response"></dd>
                        <dt class="col-sm-1" [hidden]="log.showHeaders">Headers</dt>
                        <dd class="col-sm-11" [hidden]="log.showHeaders">
                          <button type="button" class="btn btn-sm btn-success" (click)="toggleHeaders(log)">Show</button>
                        </dd>
                        <dt class="col-sm-1" [hidden]="!log.showHeaders">Request Headers</dt>
                        <dd class="col-sm-11" [pretty-print]="log.requestHeaders" [hidden]="!log.showHeaders"></dd>
                        <dt class="col-sm-1" [hidden]="!log.showHeaders">Response Headers</dt>
                        <dd class="col-sm-11" [pretty-print]="log.responseHeaders"  [hidden]="!log.showHeaders"></dd>
                      </dl>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
          <div [pagination]="filter" [total-count]="totalCount" (page-changed)="updateView(filter)"></div></div>
        </div>